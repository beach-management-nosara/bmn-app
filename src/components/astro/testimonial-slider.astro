---
import { ChevronRightIcon, ChevronLeftIcon } from "lucide-react";
import testimonials from "@/data/testimonials.json";
---

<div class="relative mx-auto flex max-w-screen-2xl items-center">
    <!-- Desktop Left Button -->
    <button
        id="btn-left-lg"
        class="mr-3 hidden rounded-full bg-primary p-2 text-white hover:bg-gray-400 lg:inline-flex"
    >
        <ChevronLeftIcon className="size-8" />
    </button>

    <div id="testimonial-slider" class="flex w-full gap-x-2 overflow-hidden px-2">
        {
            testimonials.map(testimonial => (
                <div class="w-full flex-shrink-0 rounded-lg bg-[#163057] p-4 lg:w-1/2">
                    <div class="flex items-center gap-x-3">
                        <div class="size-16 rounded-full bg-gray-400" />
                        <div>
                            <p class="font-bold">{testimonial.name}</p>
                            <small>
                                Who stayed at <strong>{testimonial.property}</strong>
                            </small>
                        </div>
                    </div>
                    <article class="prose-sm mt-3 max-h-24 overflow-y-auto">
                        {testimonial.experience}
                    </article>
                </div>
            ))
        }
    </div>

    <!-- Desktop Right Button -->
    <button
        id="btn-right-lg"
        class="ml-3 hidden rounded-full bg-primary p-2 text-white hover:bg-gray-400 lg:inline-flex"
    >
        <ChevronRightIcon className="size-8" />
    </button>

    <div class="absolute -bottom-14 left-1/2 flex -translate-x-1/2 transform items-center gap-6">
        <!-- Mobile Left Button (bottom or top) -->
        <button
            id="btn-left-sm"
            class="rounded-full bg-primary p-2 text-white hover:bg-gray-400 lg:hidden"
        >
            <ChevronLeftIcon className="size-8" />
        </button>

        <!-- Mobile Right Button (bottom or top) -->
        <button
            id="btn-right-sm"
            class="rounded-full bg-primary p-2 text-white hover:bg-gray-400 lg:hidden"
        >
            <ChevronRightIcon className="size-8" />
        </button>
    </div>
</div>

<script is:inline>
    document.addEventListener("DOMContentLoaded", () => {
        const slider = document.querySelector("#testimonial-slider");
        const slide = direction => {
            const slide = slider.querySelector("div");
            const slideWidth = slide.offsetWidth;
            const scrollAmount = slideWidth + 8; // Tailwind's gap-x-2 is 8px

            slider.scrollBy({
                left: direction === "left" ? -scrollAmount : scrollAmount,
                behavior: "smooth"
            });
        };

        document
            .querySelectorAll("[id^='btn-left']")
            .forEach(button => button.addEventListener("click", () => slide("left")));
        document
            .querySelectorAll("[id^='btn-right']")
            .forEach(button => button.addEventListener("click", () => slide("right")));
    });
</script>
